<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <script>var _hmt = _hmt || [];
            (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?55405a77e01b4d671e84dd45880905a2";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();</script><title>组件 | Api-Shop</title><meta name="description" content="一个快速易用的restful-api接口工具包，兼容：django / flask / bottle。"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.19">
    <link rel="preload" href="/api-shop/assets/js/runtime~app.776c7c51.js" as="script"><link rel="preload" href="/api-shop/assets/css/styles.7805920a.css" as="style"><link rel="preload" href="/api-shop/assets/js/640.757f6868.js" as="script"><link rel="preload" href="/api-shop/assets/js/app.87c5bc74.js" as="script">
    <link rel="stylesheet" href="/api-shop/assets/css/styles.7805920a.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/api-shop/" class=""><img class="logo" src="https://pcloth.gitee.io/api-shop/logo.png" alt="Api-Shop"><span class="site-name can-hide">Api-Shop</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/api-shop/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/api-shop/introduction/" class="nav-link" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/api-shop/start/" class="nav-link" aria-label="快速上手"><!--[--><!--]--> 快速上手 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="组件"><span class="title">组件</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="组件"><span class="title">组件</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/api-shop/components/ApiShop.html" class="nav-link" aria-label="ApiShop类"><!--[--><!--]--> ApiShop类 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/Api.html" class="nav-link" aria-label="Api类"><!--[--><!--]--> Api类 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/func.html" class="nav-link" aria-label="功能扩展"><!--[--><!--]--> 功能扩展 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/data_format.html" class="nav-link" aria-label="数据类型扩展"><!--[--><!--]--> 数据类型扩展 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/pcloth/api-shop" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/api-shop/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/api-shop/introduction/" class="nav-link" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/api-shop/start/" class="nav-link" aria-label="快速上手"><!--[--><!--]--> 快速上手 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="组件"><span class="title">组件</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="组件"><span class="title">组件</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/api-shop/components/ApiShop.html" class="nav-link" aria-label="ApiShop类"><!--[--><!--]--> ApiShop类 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/Api.html" class="nav-link" aria-label="Api类"><!--[--><!--]--> Api类 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/func.html" class="nav-link" aria-label="功能扩展"><!--[--><!--]--> 功能扩展 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/api-shop/components/data_format.html" class="nav-link" aria-label="数据类型扩展"><!--[--><!--]--> 数据类型扩展 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/pcloth/api-shop" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><section class="sidebar-group"><p class="sidebar-heading">组件</p><ul class=""><li><!--[--><a aria-current="page" href="/api-shop/components/#apishop-类组件" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="ApiShop 类组件"><!--[--><!--]--> ApiShop 类组件 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/api-shop/components/#代码中直接运行另一个api接口" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="代码中直接运行另一个api接口"><!--[--><!--]--> 代码中直接运行另一个api接口 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#apishop-conf-说明" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="ApiShop conf 说明"><!--[--><!--]--> ApiShop conf 说明 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#apishop-conf-methods-说明" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="ApiShop conf methods 说明"><!--[--><!--]--> ApiShop conf methods 说明 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#apishop-options-说明" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="ApiShop options 说明"><!--[--><!--]--> ApiShop options 说明 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#apishop-options-lang-pack-说明" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="ApiShop options lang_pack 说明"><!--[--><!--]--> ApiShop options lang_pack 说明 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#方法组件" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="方法组件"><!--[--><!--]--> 方法组件 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/api-shop/components/#get-api-result-json-方法-将删除" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="get_api_result_json 方法（将删除）"><!--[--><!--]--> get_api_result_json 方法（将删除） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/api-shop/components/#get-api-result-response-方法-将删除" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="get_api_result_response 方法（将删除）"><!--[--><!--]--> get_api_result_response 方法（将删除） <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul></section><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="组件"><a class="header-anchor" href="#组件">#</a> 组件</h1><table><thead><tr><th style="text-align:left;">模块名字</th><th style="text-align:center;">功能说明</th><th style="text-align:left;">模块介绍</th></tr></thead><tbody><tr><td style="text-align:left;">ApiShop</td><td style="text-align:center;">api初始化类</td><td style="text-align:left;">用以加载conf和options</td></tr><tr><td style="text-align:left;">api_run</td><td style="text-align:center;">ApiShop实例方法</td><td style="text-align:left;">用来在业务代码中运行别的接口(取代get_api_result_json和get_api_result_response)</td></tr><tr><td style="text-align:left;">Api</td><td style="text-align:center;">业务基础类</td><td style="text-align:left;">用来继承后写实际的业务代码</td></tr><tr><td style="text-align:left;">ApiResponseModelFields</td><td style="text-align:center;">制作包含部分model字段的response返回对象文档</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">get_api_result_json</td><td style="text-align:center;">直接调用业务类(后面版本将删除它)</td><td style="text-align:left;">返回 json,status_code</td></tr><tr><td style="text-align:left;">get_api_result_response</td><td style="text-align:center;">直接调用业务类(后面版本将删除它)</td><td style="text-align:left;">返回response</td></tr><tr><td style="text-align:left;">data_format</td><td style="text-align:center;">内置自定义数据格式</td><td style="text-align:left;">data_format.datetime 可以将一个字符串转换成datetime格式</td></tr><tr><td style="text-align:left;">data_format.DataExpansion</td><td style="text-align:center;">自定义数据基础类</td><td style="text-align:left;">用来写自定义数据格式</td></tr></tbody></table><h2 id="apishop-类组件"><a class="header-anchor" href="#apishop-类组件">#</a> ApiShop 类组件</h2><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>api-shop核心类，实例化后生成接口对象，你只需要访问实例的方法，就可以调用相应的业务代码。</p></div><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>ap <span class="token operator">=</span> ApiShop<span class="token punctuation">(</span>conf<span class="token punctuation">,</span>options<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="代码中直接运行另一个api接口"><a class="header-anchor" href="#代码中直接运行另一个api接口">#</a> 代码中直接运行另一个api接口</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>从1.12.0版本开始，ApiShop核心类提供了一个api_run的方法，用来在代码中运行另外一个api代码，方便复用。 这个方法将取代原本的get_api_result_json和get_api_result_response</p></div><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&#39;&#39;&#39;
    request   直接传入当前request，
    url       就是你想要访问的接口url
    method    如果不传入，就是 = request.method
    parameter 请求参数，如果不传入，就没有参数传入到api中
    json      默认True返回json数据，False就会返回response
&#39;&#39;&#39;</span> 
response_json<span class="token punctuation">,</span>code <span class="token operator">=</span> ap<span class="token punctuation">.</span>api_run<span class="token punctuation">(</span>request<span class="token punctuation">,</span> url<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parameter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response_json<span class="token punctuation">,</span>code<span class="token punctuation">)</span>

<span class="token comment"># 或者直接在Api实例中使用 # Or use it directly in the Api instance</span>
<span class="token keyword">class</span> <span class="token class-name">test_api</span><span class="token punctuation">(</span>Api<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        response_json<span class="token punctuation">,</span>code <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token punctuation">.</span>api_run<span class="token punctuation">(</span>request<span class="token punctuation">,</span> other_url<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parameter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>response_json<span class="token punctuation">,</span>code<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="apishop-conf-说明"><a class="header-anchor" href="#apishop-conf-说明">#</a> ApiShop conf 说明</h3><h4 id="apishop-conf-例子"><a class="header-anchor" href="#apishop-conf-例子">#</a> ApiShop conf 例子</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>conf <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&#39;url&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;class&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;account.views.api_login&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;账户登录&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;methods&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&#39;POST&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token string">&#39;required&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">&#39;min&#39;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;max&#39;</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">&#39;description&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;用户名&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token string">&#39;required&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">&#39;min&#39;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;max&#39;</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">&#39;description&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;密码&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&#39;GET&#39;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="apishop-conf-详细"><a class="header-anchor" href="#apishop-conf-详细">#</a> ApiShop conf 详细</h4><table><thead><tr><th style="text-align:left;">键</th><th style="text-align:left;">值类型</th><th style="text-align:right;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">url</td><td style="text-align:left;">str,list</td><td style="text-align:right;">接口的url地址，只需要填写相对地址，如果有多条url，可以配置成<code>list</code>。支持url参数：<code>/api/url/&lt;id&gt;</code></td></tr><tr><td style="text-align:left;">class</td><td style="text-align:left;">str,class</td><td style="text-align:right;">接口实际调用的业务类（继承至Api），可以是对象，也可以是引用地址</td></tr><tr><td style="text-align:left;">name</td><td style="text-align:left;">str</td><td style="text-align:right;">接口的名字</td></tr><tr><td style="text-align:left;">methods</td><td style="text-align:left;">dict</td><td style="text-align:right;">接口所能接收的methods：有GET POST DELETE PUT PATCH</td></tr></tbody></table><h3 id="apishop-conf-methods-说明"><a class="header-anchor" href="#apishop-conf-methods-说明">#</a> ApiShop conf methods 说明</h3><h4 id="apishop-conf-methods-详细"><a class="header-anchor" href="#apishop-conf-methods-详细">#</a> ApiShop conf methods 详细</h4><table><thead><tr><th style="text-align:left;">键</th><th style="text-align:left;">值类型</th><th style="text-align:right;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">name</td><td style="text-align:left;">str</td><td style="text-align:right;">参数名，接收后在data.name</td></tr><tr><td style="text-align:left;">type</td><td style="text-align:left;">class</td><td style="text-align:right;">str,int,float,bool,list,dict,tuple等等，也支持data_format.datetime时间格式，你也可以自定义一个类型转换器</td></tr><tr><td style="text-align:left;">required</td><td style="text-align:left;">bool</td><td style="text-align:right;">是否是必要值</td></tr><tr><td style="text-align:left;">default</td><td style="text-align:left;">str,function</td><td style="text-align:right;">当没有接收到时的默认值，注意，它也会被type所指定的类型转换器转换。当它是一个function时，如果没有收到请求参数，将会自动运行这个方法获取值，同时将不再进行类型转换。</td></tr><tr><td style="text-align:left;">min</td><td style="text-align:left;">int,str</td><td style="text-align:right;">最小值/最小长度，为字符串时，会被type指定的类型转换器转换。</td></tr><tr><td style="text-align:left;">max</td><td style="text-align:left;">int,str</td><td style="text-align:right;">最大值/最大长度，为字符串时，会被type指定的类型转换器转换。</td></tr><tr><td style="text-align:left;">description</td><td style="text-align:left;">str</td><td style="text-align:right;">功能描述，给前端人员看文档的内容</td></tr><tr><td style="text-align:left;">options</td><td style="text-align:left;">list</td><td style="text-align:right;">参数必须在这个列表中的值，例如：[1,4,7]，收到这个列表之外的参数就会触发bad_request</td></tr></tbody></table><h3 id="apishop-options-说明"><a class="header-anchor" href="#apishop-options-说明">#</a> ApiShop options 说明</h3><h4 id="apishop-options-例子"><a class="header-anchor" href="#apishop-options-例子">#</a> ApiShop options 例子</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>options <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">&#39;base_url&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;/api/&#39;</span><span class="token punctuation">,</span>
                <span class="token string">&#39;bad_request&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token string">&#39;document&#39;</span><span class="token punctuation">:</span> BASE_DIR <span class="token operator">+</span> <span class="token string">&#39;/api_shop/static/document.html&#39;</span><span class="token punctuation">,</span> 
                <span class="token string">&#39;lang&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span>
                <span class="token string">&#39;lang_pack&#39;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="apishop-options-详细"><a class="header-anchor" href="#apishop-options-详细">#</a> ApiShop options 详细</h4><table><thead><tr><th style="text-align:left;">键</th><th style="text-align:left;">值类型</th><th style="text-align:left;">默认值</th><th style="text-align:right;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">base_url</td><td style="text-align:left;">str</td><td style="text-align:left;">/api/</td><td style="text-align:right;">接口url前缀</td></tr><tr><td style="text-align:left;">bad_request</td><td style="text-align:left;">bool</td><td style="text-align:left;">True</td><td style="text-align:right;">如果请求不合法，是否以坏请求方式返回；否则就是全部是200返回</td></tr><tr><td style="text-align:left;">bad_request_error_status</td><td style="text-align:left;">str,int,bool</td><td style="text-align:left;">&#39;error&#39;</td><td style="text-align:right;">如果bad_request参数设置为False，那么这个参数就会启用，会在坏请求里附带一个status=&#39;error&#39;的信息，你可以自定义这个信息。</td></tr><tr><td style="text-align:left;">document</td><td style="text-align:left;">str(path)</td><td style="text-align:left;">略</td><td style="text-align:right;">文档页面的html模板所在的路径，默认会有一个简易模板</td></tr><tr><td style="text-align:left;">lang</td><td style="text-align:left;">str</td><td style="text-align:left;">en</td><td style="text-align:right;">多国语言支持，目前内置en, zh</td></tr><tr><td style="text-align:left;">lang_pack</td><td style="text-align:left;">dict</td><td style="text-align:left;">无</td><td style="text-align:right;">扩展语言包，如果你想让api-shop支持更多语言</td></tr><tr><td style="text-align:left;">name_classification</td><td style="text-align:left;">list</td><td style="text-align:left;">无</td><td style="text-align:right;">用于默认的文档模板对接口名称进行过滤，便于查找</td></tr><tr><td style="text-align:left;">url_classification</td><td style="text-align:left;">list</td><td style="text-align:left;">无</td><td style="text-align:right;">用于默认的文档模板对接口url进行过滤，便于查找。例子：&#39;url_classification&#39;:[&#39;weixin&#39;,&#39;login&#39;]</td></tr><tr><td style="text-align:left;">auto_create_folder</td><td style="text-align:left;">bool</td><td style="text-align:left;">False</td><td style="text-align:right;">自动创建文件夹，debug参数也必须为True才可以生效。</td></tr><tr><td style="text-align:left;">auto_create_file</td><td style="text-align:left;">bool</td><td style="text-align:left;">False</td><td style="text-align:right;">自动创建文件，debug参数也必须为True才可以生效。</td></tr><tr><td style="text-align:left;">auto_create_class</td><td style="text-align:left;">bool</td><td style="text-align:left;">False</td><td style="text-align:right;">自动创建类，debug参数也必须为True才可以生效。</td></tr><tr><td style="text-align:left;">auto_create_method</td><td style="text-align:left;">bool</td><td style="text-align:left;">False</td><td style="text-align:right;">自动创建方法，debug参数也必须为True才可以生效。</td></tr><tr><td style="text-align:left;">framework</td><td style="text-align:left;">str</td><td style="text-align:left;">无</td><td style="text-align:right;">手动指定框架，目前支持django、flask、bottle，如果不指定，将按顺序识别框架，如果同时安装了多个框架，请手动指定。</td></tr><tr><td style="text-align:left;">debug</td><td style="text-align:left;">bool</td><td style="text-align:left;">True</td><td style="text-align:right;">加载api业务代码的时候，遇到错误抛出。</td></tr></tbody></table><h3 id="apishop-options-lang-pack-说明"><a class="header-anchor" href="#apishop-options-lang-pack-说明">#</a> ApiShop options lang_pack 说明</h3><h4 id="apishop-options-lang-pack-例子"><a class="header-anchor" href="#apishop-options-lang-pack-例子">#</a> ApiShop options lang_pack 例子</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token string">&#39;lang_pack&#39;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token string">&#39;zh&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&#39;no attributes found&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;没有找到属性：&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;not found in conf&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;在conf参数中没找到方法: &#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;no such interface&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;没有这个接口&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;is required&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;是必要的&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;parameter&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;参数&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;can not be empty&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;不能为空&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;must be type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;必须是类型&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;minimum length&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;最小长度&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;minimum value&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;最小值&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;maximum length&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;最大长度&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;maximum value&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;最大值&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;The wrong configuration, methons must be loaded inside the list container.&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;错误的配置，methons必须装的list容器内。&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;no such interface method&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;这个接口没有这个method&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;Framework version is not compatible.&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;api-shop不支持当前框架版本。&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;Not support&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;不支持&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;supported framework as follows:&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;支持的框架如下：&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;Did not find the framework&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;没找指定的框架，请安装&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="方法组件"><a class="header-anchor" href="#方法组件">#</a> 方法组件</h2><h3 id="get-api-result-json-方法-将删除"><a class="header-anchor" href="#get-api-result-json-方法-将删除">#</a> get_api_result_json 方法（将删除）</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>直接调用业务代码类，获取返回数据和状态码</li><li>请注意：由于绕开了参数监测，所有参数都必须填写在data中，没有的用None填写</li></ul></div><h4 id="flask-例子"><a class="header-anchor" href="#flask-例子">#</a> flask 例子</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> api_shop <span class="token keyword">import</span> get_api_result_json

<span class="token keyword">from</span> views <span class="token keyword">import</span> api_login <span class="token comment"># 继承了Api类的业务代码</span>

<span class="token decorator annotation punctuation">@simple_page<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/test&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    data <span class="token operator">=</span> get_api_result_json<span class="token punctuation">(</span>
        api_login<span class="token punctuation">,</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;testuser&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;12345&#39;</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment"># 这样在程序内部也能快速的调用业务代码。</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">get_api_result_json 参数说明</p><ul><li>get_api_result_json(api_class, method, data=None, request=None, not200=True)</li><li>直接调用api代码，并拿到返回json <ul><li>api_class 是业务api类的对象（不是实例）</li><li>method 是请求方法,str格式</li><li>data 是附加数据，dict格式</li><li>request=None 是当前request,如果method和request.method不相同，请自己封装一个适合业务代码用的request，如果业务代码不用reqeust，请不要传入。</li><li>not200=True 是允许status_code不等于200的结果，为False的时候，遇到200以外程序中断并抛错</li></ul></li><li>return json,status_code</li></ul></div><h3 id="get-api-result-response-方法-将删除"><a class="header-anchor" href="#get-api-result-response-方法-将删除">#</a> get_api_result_response 方法（将删除）</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>直接调用业务代码类，获取返回响应包response</li><li>请注意：由于绕开了参数监测，所有参数都必须填写在data中，没有的用None填写</li></ul></div><h4 id="flask-例子-1"><a class="header-anchor" href="#flask-例子-1">#</a> flask 例子</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> api_shop <span class="token keyword">import</span> get_api_result_response

<span class="token keyword">from</span> views <span class="token keyword">import</span> api_login <span class="token comment"># 继承了Api类的业务代码</span>

<span class="token decorator annotation punctuation">@simple_page<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/test&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    response <span class="token operator">=</span> get_api_result_response<span class="token punctuation">(</span>
        api_login<span class="token punctuation">,</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;testuser&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;12345&#39;</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token comment"># 这样在程序内部也能快速的调用业务代码。</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>和get_api_result_json方法是一样的，不过get_api_result_response的返回值是一个response</p></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/pcloth/api-shop/edit/main/components/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/6/25 下午10:21:32</span></div><!----></footer><!----><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/api-shop/assets/js/runtime~app.776c7c51.js" defer></script><script src="/api-shop/assets/js/640.757f6868.js" defer></script><script src="/api-shop/assets/js/app.87c5bc74.js" defer></script>
  </body>
</html>
